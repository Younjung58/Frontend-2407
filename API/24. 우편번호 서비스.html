<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>우편번호 서비스</title>
    <script src="postcode.js"></script>
    <script type="text/javascript"></script>
</head>
<body style="margin: 40px;">
  <input type="text" id="sample4_postcode" placeholder="우편번호">
  <input type="button" onclick="sample4_execDaumPostcode()" value="우편번호 찾기"><br>
  <input type="text" id="sample4_address" placeholder="주소"><br>
  <input type="text" id="sample4_detailAddress" placeholder="상세주소">
  <input type="text" id="sample4_extraAddress" placeholder="참고항목">
  <script>
    window.onload = () => {
          const daumScript = document.createElement('script');
          daumScript.src = `${postcode}`;
          daumScript.onload = () => {
            new daum.load(() => {
                sample4_execDaumPostcode();
              });
          };
          document.head.appendChild(daumScript);
      }
      
    function sample4_execDaumPostcode() {
    
      new daum.Postcode({
        oncomplete: function(data) {

          let addr = '';
          let extraAddr = '';

          if (data.userSelectedType === 'R') { // 사용자가 도로명 주소를 선택했을 경우
              addr = data.roadAddress;
          } else { // 사용자가 지번 주소를 선택했을 경우(J)
              addr = data.jibunAddress;
          }

          if(data.userSelectedType === 'R'){
            if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                extraAddr += data.bname;
            }
            if(data.buildingName !== '' && data.apartment === 'Y' ){
              extraAddr += (extraAddr !== '' ? ', ' + data.buildingName : data.buildingName);
            }
            
            if(extraAddr !== ''){
              extraAddr = ' (' + extraAddr + ')';
            }
          // document.getElementById("sample4_extraAddress").value = extraAddr;
        }
        // else {
        //     document.getElementById("sample4_extraAddress").value = '';
        // }

        document.getElementById("sample4_postcode").value = data.zonecode;
        document.getElementById("sample4_address").value = addr;
        document.getElementById("sample4_extraAddress").value = extraAddr;

        document.getElementById("sample4_detailAddress").focus();          
      }
    }).open();
  } 
  </script>
</body>
</html>